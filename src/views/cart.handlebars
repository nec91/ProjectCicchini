<div>
  <h1>Tu Carrito</h1>

  {{#if cart.products.length}}
    <div style="display: flex; flex-wrap: wrap; gap: 20px;">
      {{#each cart.products}}
        <div style="border: 1px solid #ccc; border-radius: 8px; padding: 16px; width: 250px; text-align: center;">
          {{#if this.product.thumbnail}}
            <img src="{{this.product.thumbnail}}" alt="{{this.product.title}}" style="width: 100%; height: auto;">
          {{else}}
            <img src="https://via.placeholder.com/250x200?text=Sin+Imagen" alt="Sin Imagen" style="width: 100%; height: auto;">
          {{/if}}

          <h3>{{this.product.title}}</h3>
          <p><strong>Código:</strong> {{this.product.code}}</p>
          <p><strong>Precio:</strong> ${{this.product.price}}</p>
          <p><strong>Cantidad:</strong> {{this.quantity}}</p>
          <p><strong>Stock disponible:</strong> {{this.product.stock}}</p>

          <p><strong>Total:</strong> ${{multiply this.product.price this.quantity}}</p>

          {{#if (lte this.product.stock 0)}}
            <p style="color: red;">⚠️ Sin stock disponible</p>
          {{/if}}

          <button class="delete-btn" data-id="{{this.product._id}}" data-cart-id="{{../cart._id}}">
            Eliminar del carrito
          </button>
        </div>
      {{/each}}
    </div>

    <h3>Total del carrito: ${{cartTotal}}</h3>

    <form method="POST" action="/api/carts/{{cart._id}}/purchase">
      <button type="submit">Finalizar compra</button>
    </form>
  {{else}}
    <p>Tu carrito está vacío.</p>
  {{/if}}

  <br>
  <a href="/products">Volver a productos</a>
</div>

<script src="/js/carts.js"></script>
